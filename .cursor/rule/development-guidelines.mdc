# Development Guidelines

## ğŸ› ï¸ ê°œë°œ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­
- **Node.js**: 18+ ë²„ì „
- **Package Manager**: pnpm (í•„ìˆ˜)
- **TypeScript**: Strict mode í™œì„±í™”
- **ESLint**: ëª¨ë“  ê·œì¹™ ì¤€ìˆ˜

### ê°œë°œ ëª…ë ¹ì–´
```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰
pnpm dev

# í”„ë¡œë•ì…˜ ë¹Œë“œ (TypeScript ê²€ì‚¬ í¬í•¨)
pnpm build

# ë¦°íŠ¸ ê²€ì‚¬
pnpm lint

# ë¯¸ë¦¬ë³´ê¸°
pnpm preview
```

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ê·œì¹™

### í•„ìˆ˜ í…ŒìŠ¤íŠ¸ ì ˆì°¨
> "VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands to ensure your code is correct."

1. **ê°œë°œ ì¤‘**: `pnpm dev`ë¡œ í•« ë¦¬ë¡œë“œ í…ŒìŠ¤íŠ¸
2. **ì™„ë£Œ í›„**: `pnpm build`ë¡œ TypeScript ê²€ì¦
3. **ì»¤ë°‹ ì „**: `pnpm lint`ë¡œ ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬

### í…ŒìŠ¤íŠ¸ ìš°ì„ ìˆœìœ„
```bash
# 1ìˆœìœ„: TypeScript ì»´íŒŒì¼ í™•ì¸
pnpm build

# 2ìˆœìœ„: ê°œë°œ ì„œë²„ì—ì„œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸  
pnpm dev

# 3ìˆœìœ„: ë¦°íŠ¸ ê·œì¹™ ì¤€ìˆ˜
pnpm lint
```

## ğŸ¯ ì½”ë”© í‘œì¤€

### TypeScript ê·œì¹™
```typescript
// âœ… ê¶Œì¥: ì—„ê²©í•œ íƒ€ì… ì •ì˜
interface SelectableConfig {
  enabled: boolean;
  name: string;
  color: string;
  elementType: "block" | "inline";
}

// âŒ ê¸ˆì§€: any íƒ€ì… ì‚¬ìš©
const plugin: any = { ... };

// âœ… ê¶Œì¥: í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸
const MyComponent: React.FC<Props> = ({ prop1, prop2 }) => {
  return <div>{prop1}</div>;
};

// âŒ ê¸ˆì§€: í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ (íŠ¹ë³„í•œ ê²½ìš° ì œì™¸)
class MyComponent extends React.Component { ... }
```

### React íŒ¨í„´
```typescript
// âœ… ê¶Œì¥: useCallbackìœ¼ë¡œ í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
const handleClick = useCallback((id: string) => {
  setSelection({ selectedElementId: id });
}, [setSelection]);

// âœ… ê¶Œì¥: useMemoë¡œ ê³„ì‚° ìºì‹±
const selectableTree = useMemo(() => {
  return buildSelectableTree(parsedElements);
}, [parsedElements]);

// âœ… ê¶Œì¥: ì¡°ê±´ë¶€ ë Œë”ë§
{isSelected && <EditingToolbar />}

// âŒ ê¸ˆì§€: ë¶ˆí•„ìš”í•œ ìƒíƒœ
const [unused, setUnused] = useState();
```

## ğŸ¨ ìŠ¤íƒ€ì¼ë§ ê°€ì´ë“œë¼ì¸

### Tailwind CSS ìš°ì„ 
```tsx
// âœ… ê¶Œì¥: Tailwind í´ë˜ìŠ¤ ì‚¬ìš©
<div className="flex items-center gap-2 p-4 bg-white border rounded-lg shadow-lg">

// âŒ ê¸ˆì§€: ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ (íŠ¹ë³„í•œ ê²½ìš° ì œì™¸)
<div style={{ display: 'flex', padding: '16px' }}>

// âœ… ê¶Œì¥: cn() í•¨ìˆ˜ë¡œ ì¡°ê±´ë¶€ í´ë˜ìŠ¤
<div className={cn(
  "base-class",
  isSelected && "selected-class",
  className
)}>
```

### ì¼ê´€ëœ ìƒ‰ìƒ ì‹œìŠ¤í…œ
```typescript
const ELEMENT_COLORS = {
  text: "#10b981",      // green
  image: "#f59e0b",     // amber  
  svg: "#f59e0b",       // amber (ì´ë¯¸ì§€ì™€ ë™ì¼)
  section: "#3b82f6",   // blue
  database: "#8b5cf6",  // purple
  repeat: "#ef4444"     // red
} as const;
```

### í¬ê¸° ë‹¨ìœ„ í‘œì¤€
```css
/* ê¶Œì¥: 4px ë°°ìˆ˜ ì‚¬ìš© */
gap-1    /* 4px */
gap-2    /* 8px */
gap-4    /* 16px */
p-3      /* 12px */
h-6      /* 24px */

/* íŠ¹ë³„í•œ ê²½ìš°: í”½ì…€ ë‹¨ìœ„ */
h-[1px]  /* 1px border */
w-[240px] /* ì •í™•í•œ í¬ê¸° í•„ìš”ì‹œ */
```

## ğŸ”§ í”ŒëŸ¬ê·¸ì¸ ê°œë°œ ê°€ì´ë“œ

### í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡°
```typescript
// 1. í”ŒëŸ¬ê·¸ì¸ íŒŒì¼ ìƒì„±: src/plugins/my-plugin.tsx
export const myPlugin: Plugin = {
  name: "my-plugin",
  version: "1.0.0",
  description: "My plugin description",

  selectable: {
    enabled: true,
    name: "My Element",
    color: "#06b6d4",
    elementType: "block",
  },

  match: (element: Element) => {
    // ë§¤ì¹­ ë¡œì§
  },

  parse: (element: Element) => {
    // íŒŒì‹± ë¡œì§
  },

  render: ({ parsedElement }) => {
    // ë Œë”ë§ ë¡œì§
  },
};
```

### íƒ€ì… ì •ì˜ ì¶”ê°€
```typescript
// 2. src/types.tsì— íƒ€ì… ì¶”ê°€
interface MyElement {
  type: "my-element";
  id: string;
  // ì¶”ê°€ í”„ë¡œí¼í‹°ë“¤
}

// ParsedElement ìœ ë‹ˆì˜¨ì— ì¶”ê°€
type ParsedElement = TextElement | MyElement | ...;
```

### í”ŒëŸ¬ê·¸ì¸ ë“±ë¡
```typescript
// 3. src/plugins/index.tsì— ë“±ë¡
import { myPlugin } from './my-plugin';

export function registerDefaultPlugins() {
  // ...
  pluginManager.register(myPlugin);
}
```

## ğŸ¯ ì„ íƒ ê¸°ë°˜ í¸ì§‘ êµ¬í˜„

### ê¸°ë³¸ íŒ¨í„´
```typescript
const EditableComponent: React.FC<Props> = ({ elementId }) => {
  const selection = useEditorStore(state => state.selection);
  const isSelected = selection.selectedElementId === elementId;

  const handleClick = (e: React.MouseEvent) => {
    if (!isSelected) {
      // ì„ íƒë˜ì§€ ì•Šì€ ìƒíƒœ: ì„ íƒ ì‹œìŠ¤í…œì— ìœ„ì„
      return;
    }
    
    // ì„ íƒëœ ìƒíƒœ: í¸ì§‘ ë„êµ¬ í™œì„±í™”
    e.stopPropagation();
    openEditingInterface();
  };

  return (
    <div 
      data-block-element-id={elementId}
      onClick={handleClick}
    >
      {/* ì»¨í…ì¸  ë Œë”ë§ */}
      
      {isSelected && (
        <FloatingEditButton onClick={openEditingInterface} />
      )}
    </div>
  );
};
```

### Popover ê¸°ë°˜ í¸ì§‘ UI
```typescript
// âœ… ê¶Œì¥: ë¯¸ë‹ˆë©€í•œ Popover
<Popover open={open} onOpenChange={setOpen}>
  <PopoverContent 
    className="w-60 p-0 bg-white"
    side="top"
    align="center"
    sideOffset={8}
  >
    {/* í¸ì§‘ ì¸í„°í˜ì´ìŠ¤ */}
  </PopoverContent>
</Popover>

// âŒ ê¸ˆì§€: ë³µì¡í•œ Dialog
<Dialog>
  <DialogContent className="max-w-2xl">
    {/* í° ëª¨ë‹¬ ì¸í„°í˜ì´ìŠ¤ */}
  </DialogContent>
</Dialog>
```

## ğŸ› ë””ë²„ê¹… ê°€ì´ë“œë¼ì¸

### ì½˜ì†” ë¡œê·¸ ì‚¬ìš©
```typescript
// âœ… ê°œë°œ ì¤‘: ìƒì„¸í•œ ë””ë²„ê¹… ë¡œê·¸
console.log('ğŸ–±ï¸ Click detected at:', { x: clientX, y: clientY });
console.log('ğŸ“ Elements at point:', elementsAtPoint);
console.log('ğŸ” getSelectableConfig called with:', element);

// âœ… í”„ë¡œë•ì…˜: ì¤‘ìš”í•œ ì •ë³´ë§Œ
if (process.env.NODE_ENV === 'development') {
  console.log('Debug info:', data);
}
```

### ì—ëŸ¬ ì²˜ë¦¬
```typescript
// âœ… ê¶Œì¥: ì•ˆì „í•œ ì—ëŸ¬ ì²˜ë¦¬
try {
  const result = dangerousOperation();
  return result;
} catch (error) {
  console.error('Operation failed:', error);
  return fallbackValue;
}

// âœ… ê¶Œì¥: íƒ€ì… ê°€ë“œ ì‚¬ìš©
if (element.type === 'text') {
  // íƒ€ì…ì´ í™•ì‹¤í•œ ê²½ìš°ì—ë§Œ ì§„í–‰
  handleTextElement(element);
}
```

## ğŸ“Š ì„±ëŠ¥ ìµœì í™” ê°€ì´ë“œ

### React ìµœì í™”
```typescript
// âœ… ë©”ëª¨ì´ì œì´ì…˜ ì ê·¹ í™œìš©
const MemoizedComponent = React.memo(({ prop1, prop2 }) => {
  return <div>{prop1}</div>;
});

// âœ… ì˜ì¡´ì„± ë°°ì—´ ìµœì í™”
const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]); // í•„ìš”í•œ ê²ƒë§Œ ì˜ì¡´ì„±ì— í¬í•¨

// âœ… ì¡°ê±´ë¶€ ë Œë”ë§ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ ë°©ì§€
{shouldRender && <ExpensiveComponent />}
```

### ì´ë²¤íŠ¸ ìµœì í™”
```typescript
// âœ… ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©
const handleDocumentClick = useCallback((e: MouseEvent) => {
  const target = e.target as Element;
  // í•˜ë‚˜ì˜ ë¦¬ìŠ¤ë„ˆë¡œ ëª¨ë“  í´ë¦­ ì²˜ë¦¬
}, []);

// âœ… ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
const handleClick = useCallback((id: string) => {
  setSelection({ selectedElementId: id });
}, []); // ì˜ì¡´ì„± ìµœì†Œí™”
```

## ğŸš€ ë°°í¬ ê°€ì´ë“œë¼ì¸

### ì»¤ë°‹ ë©”ì‹œì§€ ê·œì¹™
```bash
# í˜•ì‹: type: description
feat: add SVG plugin with popover UI
fix: resolve selection system bug
refactor: improve plugin architecture
docs: update development guidelines

# ìƒì„¸ ì„¤ëª…ì´ í•„ìš”í•œ ê²½ìš°
feat: implement selection-based editing workflow

- Add document.elementsFromPoint for accurate targeting
- Create Builder.io-style popover interface
- Include shadcn/ui components integration
- Fix tab switching bug in popover

ğŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

### ë¹Œë“œ ê²€ì¦
```bash
# 1. TypeScript ê²€ì‚¬
pnpm build

# 2. ë¦°íŠ¸ í†µê³¼ í™•ì¸
pnpm lint

# 3. ìˆ˜ë™ í…ŒìŠ¤íŠ¸
pnpm dev
# ë¸Œë¼ìš°ì €ì—ì„œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

# 4. ì»¤ë°‹ ë° í‘¸ì‹œ
git add .
git commit -m "feat: implement new feature"
git push
```

## ğŸ”’ ë³´ì•ˆ ê°€ì´ë“œë¼ì¸

### XSS ë°©ì§€
```typescript
// âœ… ì•ˆì „í•œ HTML ë Œë”ë§
<div dangerouslySetInnerHTML={{ __html: sanitizedHtml }} />

// âŒ ìœ„í—˜í•œ ì§ì ‘ ì‚½ì…
<div innerHTML={userInput} /> // ì ˆëŒ€ ê¸ˆì§€

// âœ… ì‚¬ìš©ì ì…ë ¥ ê²€ì¦
const isValidSvg = (input: string) => {
  return input.startsWith('<svg') && input.endsWith('</svg>');
};
```

### ë¯¼ê° ì •ë³´ ë³´í˜¸
```typescript
// âŒ ê¸ˆì§€: ì½˜ì†”ì— ë¯¼ê° ì •ë³´ ì¶œë ¥
console.log('User data:', userData);

// âœ… ê¶Œì¥: ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì œí•œì  ë¡œê¹…
if (process.env.NODE_ENV === 'development') {
  console.log('Debug info (no sensitive data)');
}
```

## ğŸ“š í•™ìŠµ ë¦¬ì†ŒìŠ¤

### í•„ìˆ˜ ë¬¸ì„œ
- [React ê³µì‹ ë¬¸ì„œ](https://react.dev/)
- [TypeScript í•¸ë“œë¶](https://www.typescriptlang.org/docs/)
- [Tailwind CSS ë¬¸ì„œ](https://tailwindcss.com/docs)
- [shadcn/ui ì»´í¬ë„ŒíŠ¸](https://ui.shadcn.com/)

### í”„ë¡œì íŠ¸ íŠ¹í™” ì§€ì‹
- [Zustand ìƒíƒœ ê´€ë¦¬](https://zustand-demo.pmnd.rs/)
- [Radix UI í”„ë¦¬ë¯¸í‹°ë¸Œ](https://www.radix-ui.com/)
- [Builder.io ë””ìì¸ ì² í•™](https://www.builder.io/)

## â“ ë¬¸ì œ í•´ê²°

### ìì£¼ ë°œìƒí•˜ëŠ” ì´ìŠˆ
1. **ì„ íƒì´ ì•ˆ ë˜ëŠ” ê²½ìš°**: `buildSelectableTree` ë””ë²„ê¹…
2. **íƒ€ì… ì—ëŸ¬**: `pnpm build`ë¡œ í™•ì¸
3. **ìŠ¤íƒ€ì¼ë§ ë¬¸ì œ**: Tailwind í´ë˜ìŠ¤ ì¶©ëŒ í™•ì¸
4. **ì„±ëŠ¥ ì´ìŠˆ**: React DevTools Profiler ì‚¬ìš©

### ë„ì›€ ìš”ì²­ ì‹œ
1. ì—ëŸ¬ ë©”ì‹œì§€ ì „ë¬¸ ê³µìœ 
2. ì¬í˜„ ë‹¨ê³„ ì„¤ëª…
3. ì˜ˆìƒ ë™ì‘ vs ì‹¤ì œ ë™ì‘
4. ê´€ë ¨ ì½”ë“œ ìŠ¤ë‹ˆí« ì²¨ë¶€